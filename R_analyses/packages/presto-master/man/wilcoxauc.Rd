% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/wilcoxauc.R
\name{wilcoxauc}
\alias{wilcoxauc}
\alias{wilcoxauc.seurat}
\alias{wilcoxauc.Seurat}
\alias{wilcoxauc.SingleCellExperiment}
\alias{wilcoxauc.default}
\title{Fast Wilcoxon rank sum test and auROC}
\usage{
wilcoxauc(X, ...)

\method{wilcoxauc}{seurat}(X, ...)

\method{wilcoxauc}{Seurat}(
  X,
  group_by = NULL,
  assay = "data",
  groups_use = NULL,
  seurat_assay = "RNA",
  ...
)

\method{wilcoxauc}{SingleCellExperiment}(X, group_by = NULL, assay = NULL, groups_use = NULL, ...)

\method{wilcoxauc}{default}(X, y, groups_use = NULL, verbose = TRUE, ...)
}
\arguments{
\item{X}{A feature-by-sample matrix, Seurat object, or SingleCellExperiment
object}

\item{...}{input specific parameters.}

\item{group_by}{(Seurat & SCE) name of groups variable ('e.g. Cluster').}

\item{assay}{(Seurat & SCE) name of feature matrix slot (e.g. 'data' or
'logcounts').}

\item{groups_use}{(optional) which groups from y vector to test.}

\item{seurat_assay}{(Seurat) name of Seurat Assay (e.g. 'RNA').}

\item{y}{vector of group labels.}

\item{verbose}{boolean, TRUE for warnings and messages.}
}
\value{
table with the following columns:
\itemize{
\item \strong{feature} - feature name (e.g. gene name).
\item \strong{group} - group name.
\item \strong{avgExpr} - mean value of feature in group.
\item \strong{logFC} - log fold change between observations in group vs out.
\item \strong{statistic} - Wilcoxon rank sum U statistic.
\item \strong{auc} - area under the receiver operator curve.
\item \strong{pval} - nominal p value.
\item \strong{padj} - Benjamini-Hochberg adjusted p value.
\item \strong{pct_in} - Percent of observations in the group with non-zero
feature value.
\item \strong{pct_out} - Percent of observations out of the group with
non-zero feature value.
}
}
\description{
Computes auROC and Wilcoxon p-value based on Gaussian approximation. 
Inputs can be 
\itemize{
\item Dense matrix or data.frame
\item Sparse matrix, such as dgCMatrix
\item Seurat V3 object
\item SingleCellExperiment object
}
For detailed examples, consult the presto vignette.
}
\examples{
\dontrun{
 data(exprs)
 data(y)

 ## on a dense matrix
 head(wilcoxauc(exprs, y))

 ## with only some groups
 head(wilcoxauc(exprs, y, c('A', 'B')))

 ## on a sparse matrix
 exprs_sparse <- as(exprs, 'dgCMatrix')
 head(wilcoxauc(exprs_sparse, y))

 ## on a Seurat V3 object
 if (requireNamespace("Seurat", quietly = TRUE)) {
     pkg_version <- packageVersion('Seurat')
     if (pkg_version >= "3.0" & pkg_version < "4.0") {
         data(object_seurat)
         head(wilcoxauc(object_seurat, 'cell_type'))
     }
 }

 ## on a SingleCellExperiment object
 if (requireNamespace("SingleCellExperiment", quietly = TRUE)) {
     data(object_sce)
     head(wilcoxauc(object_sce, 'cell_type'))
 }
}

}
